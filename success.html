<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ì„±ê³µ - ì¸ìƒí¬íŠ¸í´ë¦¬ì˜¤</title>
  <style>
    body {
      margin: 0;
      font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto,
        "Noto Sans KR", "Apple SD Gothic Neo", "Malgun Gothic", sans-serif;
      background: #f9fafb;
      color: #111827;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }
    .wrap {
      max-width: 460px;
      margin: 0 auto;
      padding: 48px 24px;
      text-align: center;
      background: #fff;
      border-radius: 14px;
      box-shadow: 0 4px 12px rgba(0,0,0,.08);
    }
    h1 {
      font-size: 24px;
      font-weight: 800;
      color: #10b981;
      margin-bottom: 16px;
    }
    p { margin: 10px 0; font-size: 16px; color: #374151; }

    .btn {
      display: block;
      padding: 14px 22px;
      border-radius: 10px;
      background: linear-gradient(180deg, #3B82F6 0%, #2563EB 100%);
      color: #fff;
      text-decoration: none;
      font-weight: 600;
      font-size: 15px;
      box-shadow: 0 6px 14px rgba(37,99,235,0.35),
                  inset 0 1px 2px rgba(255,255,255,0.3);
      transition: transform 0.25s ease;
      width: 100%;
      max-width: 320px;
      margin: 16px auto 0;
      text-align: center;
    }
    .btn:hover {
      transform: translateY(-2px);
      background: linear-gradient(180deg,#1E40AF 0%,#1D4ED8 100%);
    }

    .user-box {
      margin-top: 20px;
      padding: 16px;
      background: #f3f4f6;
      border-radius: 8px;
      font-size: 14px;
      text-align: left;
    }

    .loading {
      font-size: 14px;
      color: #6b7280;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <h1 id="successTitle">âœ… ë¡œê·¸ì¸/íšŒì›ê°€ì… ì„±ê³µ</h1>
    <p id="successMsg">í™˜ì˜í•©ë‹ˆë‹¤! ì¸ìƒí¬íŠ¸í´ë¦¬ì˜¤ ì„œë¹„ìŠ¤ë¥¼ ì´ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

    <div class="user-box" id="userInfo">
      <div class="loading">ì‚¬ìš©ì ì •ë³´ë¥¼ í™•ì¸í•˜ëŠ” ì¤‘...</div>
    </div>

    <a class="btn" href="product.html">ìƒí’ˆ í˜ì´ì§€ë¡œ ì´ë™í•˜ê¸° â†’</a>
    <a class="btn" href="#" id="logoutBtn">ë¡œê·¸ì•„ì›ƒ</a>
  </div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.3/firebase-app.js";
import {
  getAuth,
  onAuthStateChanged,
  signOut
} from "https://www.gstatic.com/firebasejs/10.12.3/firebase-auth.js";

const firebaseConfig = {
  apiKey: "AIzaSyB6xU5IVpbg8661WaPKTAXsg_5vuC3sPY4",
  authDomain: "lifeportfolio.firebaseapp.com",
  projectId: "lifeportfolio",
  appId: "1:1090689178284:web:1eea462fa10cddca85d0d9"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);

const infoBox = document.getElementById("userInfo");
const title = document.getElementById("successTitle");
const msg = document.getElementById("successMsg");

// âœ… URL íŒŒë¼ë¯¸í„°ë¡œ ë¡œê·¸ì¸/íšŒì›ê°€ì… êµ¬ë¶„
const params = new URLSearchParams(window.location.search);
const mode = params.get("mode");

if (mode === "login") {
  title.textContent = "âœ… ë¡œê·¸ì¸ ì„±ê³µ";
  msg.textContent = "ë‹¤ì‹œ ì˜¤ì‹  ê²ƒì„ í™˜ì˜í•©ë‹ˆë‹¤!";
} else if (mode === "signup") {
  title.textContent = "ğŸ‰ íšŒì›ê°€ì… ì„±ê³µ";
  msg.textContent = "ì²˜ìŒ ì˜¤ì‹  ê²ƒì„ í™˜ì˜í•©ë‹ˆë‹¤! ì¸ìƒí¬íŠ¸í´ë¦¬ì˜¤ ì—¬ì •ì„ ì‹œì‘í•´ë³´ì„¸ìš”.";
}

// âœ… iOS ëŒ€ì‘ í•µì‹¬: ì¸ì¦ ê°€ë“œ
let checked = false;

onAuthStateChanged(auth, (user) => {
  if (user) {
    checked = true;
    infoBox.innerHTML = `
      <p><b>ì´ë¦„:</b> ${user.displayName || "ì´ë¦„ ì—†ìŒ"}</p>
      <p><b>ì´ë©”ì¼:</b> ${user.email}</p>
    `;
  } else {
    // â± redirect ì§í›„ íƒ€ì´ë° ë³´ì • (iOS)
    if (!checked) {
      setTimeout(() => {
        if (!auth.currentUser) {
          alert("ë¡œê·¸ì¸ ì •ë³´ê°€ í™•ì¸ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ë‹¤ì‹œ ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”.");
          window.location.replace("login.html");
        }
      }, 1200);
    }
  }
});

// âœ… ë¡œê·¸ì•„ì›ƒ
document.getElementById("logoutBtn").addEventListener("click", async (e) => {
  e.preventDefault();
  await signOut(auth);
  alert("ë¡œê·¸ì•„ì›ƒ ë˜ì—ˆìŠµë‹ˆë‹¤.");
  window.location.replace("index.html");
});
</script>
</body>
</html>
